<h2>Documentation</h2>
<p class="small text-muted">This documentation was last updated on {{buildInfo.buildDateTimeUtc | date:'medium'}}.</p>
<div class="row">
  <div class="col-md-6">
    <h5>Source code</h5>
    <p><i class="bi bi-github"></i>&nbsp;<a href="https://github.com/hyprsoftcorp/Webhooks" title="Webhooks Source Code" target="_blank">https://github.com/hyprsoftcorp/Webhooks</a> (MIT licensed)</p>
  </div>
  <div class="col-md-6">
    <h5>API documentation</h5>
    <p><i class="bi bi-cloud-check-fill"></i>&nbsp;<a href="/swagger" title="Webhooks API">https://webhooks.hyprsoft.com/swagger</a></p>
  </div>
</div>
<hr />
<h3>Sample Code</h3>
<pre><code language="csharp" [highlight]="code" lineNumbers></code></pre>
<hr />
<h3>Components</h3>
<div class="row">
  <div class="col-md-6">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Webhooks Server Web App <span class="badge bg-primary">REST API</span></h5>
        <h6 class="card-subtitle mb-2 text-muted">.NET 8</h6>
        <div class="card-text">
          Standalone web app (or Windows service) that exposes REST endpoints and services to manage subscriptions and publish events.
          <ul>
            <li>Subscribe(subscriptionRequest).</li>
            <li>Unsubscribe(subscriptionRequest).</li>
            <li>Publish(event).</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Webhooks Client Web App <span class="badge bg-primary">REST API</span></h5>
        <h6 class="card-subtitle mb-2 text-muted">.NET 8</h6>
        <div class="card-text">
          Standalone web app to publish random test events and consume webhooks.
          <ul>
            <li>Webhook receivers.</li>
            <li>Event publishing background worker (publishes a ping event every 1 to 60 seconds).</li>
          </ul>
        </div>
      </div>
    </div>
  </div>  
</div>
<div class="row">
  <div class="col-md-6">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Webhooks Server <span class="badge bg-info">Nuget</span></h5>
        <h6 class="card-subtitle mb-2 text-muted">.NET 8</h6>
        <div class="card-text">
          Nuget package to manage subscriptions and publish events using Hangfire's scalable queues and automatic retry logic with exponential backoff.  This is part of the Webhooks Server Web App.
          <ul>
            <li>SubscribeAsync(eventName, webhookUri, filter).</li>
            <li>UnsubscribeAsync(eventName, webhookUri).</li>
            <li>PublishAsync&lt;TEvent&gt;(event).</li>
            <li>GetSubscriptionsAsync().</li>
            <li>DispatchAsync&lt;TEvent&gt;(webhookUri, event).</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Webhooks Client <span class="badge bg-info">Nuget</span></h5>
        <h6 class="card-subtitle mb-2 text-muted">.NET 8</h6>
        <div class="card-text">
          Lightweight Nuget package to call the Webhooks Server Web App REST API.  Used in both the server and client web apps.
          <ul>
            <li>SubscribeAsync&lt;TEvent&gt;(webhookUri, filter).</li>
            <li>UnsubscribeAsync&lt;TEvent&gt;(webhookUri).</li>
            <li>PublishAsync&lt;TEvent&gt;(event).</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Webhooks Database <span class="badge bg-secondary">Database Store</span></h5>
        <h6 class="card-subtitle mb-2 text-muted">SQL Server or InMemory</h6>
        <div class="card-text">
          Standalone database to manage subscriptions and dispatch events.
          <ul>
            <li>Event subscriptions and audits.</li>
            <li>Hangfire related.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
<hr />
<h3>Screenshots</h3>
<div class="row">
  <div class="col-md-6">
    <h4>Webhooks Server Hangfire Dashboard</h4>
    <a href="/assets/images/webhooks-dashboard-screenshot.jpg" title="Webhooks Server Web App Dashboard Screenshot" target="_blank"><img class="img-fluid img-thumbnail" src="/assets/images/webhooks-dashboard-screenshot.jpg" alt="Webhooks Server Web App Dashboard Screenshot" asp-append-version="true" /></a>
  </div>
  <div class="col-md-6">
    <h4>Webhooks Client Web App (end-to-end example)</h4>
    <a href="/assets/images/webhooks-client-console-screenshot.jpg" title="Webhooks Client Web App Console Screenshot" target="_blank"><img class="img-fluid img-thumbnail" src="/assets/images/webhooks-client-console-screenshot.jpg" alt="Webhooks Client Web App Console Screenshot" asp-append-version="true" /></a>
  </div>
</div>

<hr />
<h3>Workflows</h3>
<div class="row">
  <div class="col-md-12">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Event Subscription</h5>
        <h6 class="card-subtitle mb-2 text-muted">Using the Webhooks Client Nuget Package</h6>
        <div class="card-text">
          <ol>
            <li>Subscriber subscribes to an event by sending the webhook uri, and optionally a filter (lambda expression).  This operation is idempotent.</li>
            <li>Subscriber optionally unsubscribes from an event by sending the webhook uri.  This operation is idempotent.</li>
            <li>Event subscriptions can be viewed <a routerLink="/subscriptions">here</a>.</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Publishing Events</h5>
        <h6 class="card-subtitle mb-2 text-muted">Using the Webhooks Client Nuget Package</h6>
        <div class="card-text">
          <ol>
            <li>Publisher simply publishes the event.</li>
          </ol>
          Backend logic:
          <ol>
            <li>The Webhooks Manager queries the event subscription repository for all webhooks associated with the event and optionally publishes the event based on any event filters.</li>
            <li>The Hangfire Webhooks Manager then enqeues each webhook request as an individual background job.</li>
            <li>Periodically Hangfire will dequeue events and invoke the callback supplied when the event was enqueued (in this case the Dispatch&lt;TEvent&gt;(webhookUri, event) API).  Failures are automatically requeued and retried using exponential backoff.  Failures can also be manually requeued if needed.</li>
            <li>Background jobs can be viewed <a href="/hangfire/jobs/succeeded" title="Hangfire Dashboard">here</a>.</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</div>
